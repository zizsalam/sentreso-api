{% extends "admin/base.html" %}

{% block title %}Agent Detail - Pinpay Admin{% endblock %}

{% block content %}
<div class="admin-page">
    <header class="page-header">
        <h1 class="page-title">Agent detail</h1>
        <p class="page-subtitle">Customer / driver profile</p>
    </header>

    <div class="collections-table-wrapper">
        <table class="collections-table">
            <tbody>
                <tr><th>Name</th><td>{{ agent.name }}</td></tr>
                <tr><th>WhatsApp</th><td>{{ agent.whatsapp_number }}</td></tr>
                <tr><th>Phone</th><td>{{ agent.phone_number|default:"-" }}</td></tr>
                <tr><th>Active</th><td>{{ agent.is_active }}</td></tr>
                <tr><th>Risk Score</th><td>{{ agent.risk_score }}</td></tr>
                <tr><th>Created</th><td>{{ agent.created_at }}</td></tr>
            </tbody>
        </table>
    </div>

    <div class="table-section">
        <h3>Last 10 Collections</h3>
        <table class="collections-table">
            <thead>
                <tr>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Reference</th>
                    <th>Created</th>
                </tr>
            </thead>
            <tbody>
                {% for c in collections %}
                <tr>
                    <td>{{ c.amount }} FCFA</td>
                    <td>{{ c.get_status_display }}</td>
                    <td>{{ c.transaction_reference|default:"-" }}</td>
                    <td>{{ c.created_at }}</td>
                </tr>
                {% empty %}
                <tr><td colspan="4" class="empty">No collections.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="table-section">
        <h3>Last 10 WhatsApp messages</h3>
        <table class="collections-table">
            <thead>
                <tr>
                    <th>To</th>
                    <th>Status</th>
                    <th>Template</th>
                    <th>Created</th>
                </tr>
            </thead>
            <tbody>
                {% for msg in messages %}
                <tr>
                    <td>{{ msg.to_number }}</td>
                    <td>{{ msg.status }}</td>
                    <td>{{ msg.template.whatsapp_template_name|default:"custom" }}</td>
                    <td>{{ msg.created_at }}</td>
                </tr>
                {% empty %}
                <tr><td colspan="4" class="empty">No messages.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}


